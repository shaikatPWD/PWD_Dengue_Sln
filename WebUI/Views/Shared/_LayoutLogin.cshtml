@model DEL.Auth.DTO.LogOnDto
<!DOCTYPE html>

<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta charset="utf-8" />
    <title></title>

    <meta name="description" content="User login page" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />

    <!-- bootstrap & fontawesome -->
    <link href="~/Content/customassets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/customassets/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" />
    <!-- text fonts -->
    <link href="~/Content/customassets/fonts/fonts.googleapis.com.css" rel="stylesheet" />
    <!-- ace styles -->
    <link href="~/Content/customassets/css/ace.min.css" rel="stylesheet" />
    <!--[if lte IE 9]>
            <link href="~/Content/customassets/css/ace-part2.min.css" rel="stylesheet" />
        <![endif]-->
    <link href="~/Content/customassets/css/ace-rtl.min.css" rel="stylesheet" />
    <!--[if lte IE 9]>
            <link href="~/Content/customassets/css/ace-ie.min.css" rel="stylesheet" />
    <![endif]-->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="~/Content/customassets/js/html5shiv.min.js"></script>
        <script src="~/Content/customassets/js/respond.min.js"></script>
    <![endif]-->
    <style type="text/css">

        .inputRadiusText {
            height: 45px !important;
            border-radius: 0.5em;
            margin-bottom: 10px;
        }
    </style>
</head>

<body class="login-layout" style="background-color: #56BAED">

    <div class="main-container">
        <div class="main-content">
            <div class="row">
                <div class="col-sm-10 col-sm-offset-1">
                    <div class="login-container">
                        @*<div class="center">
                                <img style="padding-top:75px; width:250px" src="~/Content/Images/favicon.png" />
                            </div>*@
                        <div class="space-6"></div>
                        <div class="position-relative">

                            <div class="widget-body" style="border-radius: 0.5em;">
                                <div class="widget-main">
                                    <div class="center" style="padding-bottom:20px;">
                                        <img style="height: 80px; width: 80px;" src="~/Content/Images/favicon.png" />
                                    </div>
                                    <div style="text-align: center; padding-bottom: 20px; font-weight:bold;">
                                        <h7 class="bigger">
                                            Dengue Prevention Management Monitoring System
                                        </h7>
                                    </div>
                                    <fieldset>
                                        @using (Html.BeginForm("Login", "Login", FormMethod.Post, new { @id = "_loginform_" }))
                                        {
                                            <label class="block clearfix" style="width:315px; margin-left:18px;">
                                                <span class="block input-icon input-icon-left">
                                                    @*<input type="text" class="form-control" placeholder="Username" />*@

                                                    @Html.TextBoxFor(m => m.UserName, new { id = "UserName", @placeholder = "User Name", @class = "form-control center inputRadiusText" })

                                                    <i class="ace-icon fa fa-user"></i>

                                                </span>
                                            </label>
                                            <label class="block clearfix" style="width: 315px; margin-left: 18px;">
                                                <span class="block input-icon input-icon-left">
                                                    @*<input type="password" class="form-control" placeholder="Password" />*@

                                                    @Html.PasswordFor(m => m.Password, new { @id = "Password", @placeholder = "Password", @class = "form-control center inputRadiusText" })
                                                    <i class="ace-icon fa fa-lock"></i>

                                                </span>
                                            </label>
                                            <div class="block clearfix center">
                                                <input type="text" id="first_num" class="inputRadiusText" name="first_num" style="font-family:Arial, FontAwesome; width: 90px; text-align:center;">
                                                +
                                                <input type="text" id="sec_num" class="inputRadiusText" name="second_num" style="font-family: Arial, FontAwesome; width: 90px; text-align:center;">
                                                =
                                                <input type="text" id="ans" class="inputRadiusText" name="answer" style="font-family: Arial, FontAwesome; width: 90px; text-align: center;">
                                            </div>
                                            @Html.HiddenFor(m => m.Key, new { @id = "_key_" })
                                            @Html.HiddenFor(m => m.PasswordHex, new { @id = "_hex_" })
                                            <div class="space"></div>

                                            <div class="clearfix center" style="padding-bottom:15px;">
                                                <button type="button" id="btnLogin" class="btn-round" onclick="return submitLoginForm();" style="border:0; background-color: #56BAED; margin-top: 5%; cursor: pointer; border-radius: 0.5em; height:45px; width:180px; ">
                                                    <span class="bigger-110">Login</span>
                                                </button>
                                            </div>
                                            if (Model != null)
                                            {
                                                if (Model.ErrMessage != null)
                                                {
                                                    <div class="row">
                                                        <span>@Html.Display(Model.ErrMessage)</span>
                                                    </div>
                                                }
                                            }
                                            @RenderBody()
                                            <div class="space-6"></div>
                                        }
                                        <div class="center">
                                            <a href="Dengue_Prevention.pdf" style="color:#000; margin-bottom:10px; text-decoration:underline; font-size:14px;" target="_blank">Download User Manual </a>
                                        </div>
                                        <!-- Remind Passowrd -->
                                        <div class="footer">
                                            <div class="footer-inner">
                                                <div class="footer-content center">
                                                    <!-- <a class="underlineHover" href="#">Forgot Password?</a> -->
                                                    <span class="bigger-120">
                                                        <a style="font-size: 14px;color: black" href="#">&copy;2021 All Right Reserved By PWD</a>
                                                    </span>
                                                    <!--<a style="font-size: 14px;color: black" href="#">System Development By Shell Technologies</a>-->
                                                </div>
                                            </div>
                                        </div>

                                    </fieldset>
                                </div>
                            </div>

                        </div>
                    </div>
                </div><!-- /.col -->
            </div><!-- /.row -->
        </div><!-- /.main-content -->

    </div><!-- /.main-container -->
    <!-- basic scripts -->
    <script src="~/Scripts/jquery-2.2.3.js"></script>

    <!-- crypto js -->
    <script src="~/Scripts/CryptoJS/core.js"></script>
    <script src="~/Scripts/CryptoJS/enc-base64.js"></script>
    <script src="~/Scripts/CryptoJS/md5.js"></script>
    <script src="~/Scripts/CryptoJS/evpkdf.js"></script>
    <script src="~/Scripts/CryptoJS/cipher-core.js"></script>
    <script src="~/Scripts/CryptoJS/aes.js"></script>
    <!--[if !IE]> -->
    <script src="~/Content/customassets/js/jquery.2.1.1.min.js"></script>
    @*<script src="~/Content/customassets/plugins/icheck.js"></script>*@
    <!-- <![endif]-->
    <!--[if IE]>
    <script src="~/Content/customassets/js/jquery.1.11.1.min.js"></script>
    <![endif]-->
    <!--[if !IE]> -->
    <script type="text/javascript">
        window.jQuery || document.write("<script src='~/Content/customassets/js/jquery.min.js'>" + "<" + "/script>");
    </script>

    <!-- <![endif]-->
    <!--[if IE]>
    <script type="text/javascript">
     window.jQuery || document.write("<script src='~/Content/customassets/js/jquery1x.min.js'>"+"<"+"/script>");
    </script>
    <![endif]-->
    <script type="text/javascript">
        if ('ontouchstart' in document.documentElement) document.write("<script src='~/Content/customassets/js/jquery.mobile.custom.min.js'>" + "<" + "/script>");
    </script>

    <!-- inline scripts related to this page -->



    <script type="text/javascript">

        jQuery(function ($) {
            $(document).on('click', '.toolbar a[data-target]', function (e) {
                e.preventDefault();
                var target = $(this).data('target');
                $('.widget-box.visible').removeClass('visible');//hide others
                $(target).addClass('visible');//show target
            });
        });



        //you don't need this, just used for changing background
        jQuery(function ($) {
            $('#btn-login-dark').on('click', function (e) {
                $('body').attr('class', 'login-layout');
                $('#id-text2').attr('class', 'white');
                $('#id-Company-text').attr('class', 'blue');

                e.preventDefault();
            });
            $('#btn-login-light').on('click', function (e) {
                $('body').attr('class', 'login-layout light-login');
                $('#id-text2').attr('class', 'grey');
                $('#id-Company-text').attr('class', 'blue');

                e.preventDefault();
            });
            $('#btn-login-blur').on('click', function (e) {
                $('body').attr('class', 'login-layout blur-login');
                $('#id-text2').attr('class', 'white');
                $('#id-Company-text').attr('class', 'light-blue');

                e.preventDefault();
            });

        });
    </script>
    <script>
        //$(function () {
        //  $('input').iCheck({
        //    checkboxClass: 'icheckbox_square-blue',
        //    radioClass: 'iradio_square-blue',
        //    increaseArea: '20%' // optional
        //  });
        //});
        var bt = document.getElementById('btnLogin');

        var x = Math.floor((Math.random() * 9) + 1);
        document.getElementById("first_num").value = x;
        var y = Math.floor((Math.random() * 9) + 1);
        document.getElementById("sec_num").value = y;

        var z = x + y;

        //var r = document.getElementById("answer").value;

        

        function submitLoginForm() {
            
            var r = parseInt(document.getElementById("ans").value);

            if (z == r) {

                $.getJSON('/Login/GetKey', function (data) {
                    $('#_key_').val(data.Key);
                }).done(function () {
                    // do encryption
                    var pass = $('#Password').val();
                    var key = $('#_key_').val();
                    doEncryption_by_crypto_js(key, pass);
                    $('#Password').val('***************');
                    //submit form
                    setTimeout(function () { _loginform_.submit(); }, 1000);
                });
            }
            else {
                alert("Your given number is incorrect! ");
            }
            //console.log(r);
        }
        //Submit On Enter //
        $(document).keypress(function (e) {
            var key = e.which;
            if (key == 13)  // the enter key code
            {
                return submitLoginForm();
            }
        })
        function doEncryption_by_crypto_js(secret, msg) {
            var key = CryptoJS.enc.Utf8.parse('AMINHAKEYTEM32NYTES1234567891234');
            var iv = CryptoJS.enc.Utf8.parse('7061737323313233');
            var encrypted = CryptoJS.AES.encrypt(
                CryptoJS.enc.Utf8.parse(msg),
                secret,
                key,
                {
                    keySize: 128,
                    iv: iv,
                    mode: CryptoJS.mode.CBC,
                    padding: CryptoJS.pad.Pkcs7
                }
            );
            $('#_hex_').val(encrypted);
            console.log(encrypted);
        }
    </script>

    <script type="text/javascript">
        function myFunction() {
            //alert("You pressed a key inside the input field");

            var bt = document.getElementById('btnLogin');

            var x = Math.floor((Math.random() * 9) + 1);
            document.getElementById("first_num").value = x;
            var y = Math.floor((Math.random() * 9) + 1);
            document.getElementById("sec_num").value = y;

            var z = x + y;

            var r = document.getElementById("answer").value;

            if (z != r) {
                bt.disabled = true;
            }
        }
    </script>

</body>
</html>
